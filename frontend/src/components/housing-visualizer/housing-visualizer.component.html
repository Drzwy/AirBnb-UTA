<app-navbar></app-navbar>

<div class="container">
  <h1 class="h2 my-3 py-2">{{ house.houseName }}</h1>
  <div class="row my-3">
    <app-images-card *ngIf="house.imagesUrl" [imageUrls]="house.imagesUrl" />
  </div>
</div>

<div class="container">
  <div class="row justify-content-between border-bottom mt-4">
    <div class="col-12 col-lg-6 col-xl-7">
      <div class="border-bottom">
        <h4 class="h4">
          @if (house.location && house.houseType) {
            {{ house.houseType }} {{ TEXTS.locatedIn }} {{ house.location }}
          }
        </h4>

        <h6 class="h6 fw-normal mb-4">
          <app-housing-info-displayer
            [housingInformation]="this.house.informationOfNumber"
          />
        </h6>
      </div>
      <div class="border-bottom">
        <h4 class="h4 my-4">
          {{ TEXTS.description }}
        </h4>

        <div class="mb-4">
          @for (
            parragraphs of house.houseDescriptionParagraphs;
            track parragraphs
          ) {
            <p>
              {{ parragraphs }}
            </p>
          }
        </div>
      </div>
      <div class="">
        <h4 class="h4 mt-4">
          {{ TEXTS.servicesList }}
        </h4>

        <div class="row">
          @for (service of house.services; track service) {
            <div class="col-6 my-4">
              <h4 class="h6 fw-normal">{{ service }}</h4>
            </div>
          }
        </div>
      </div>
    </div>
    <div class="col-12 col-lg-5 col-xl-4 mb-4">
      <div class="card shadow mt-4 mt-md-0">
        <div class="container">
          <div class="row my-4 mx-1">
            <app-housing-reservation
              [housingPrice]="this.house.prices"
              [rules]="this.house.rules"
            ></app-housing-reservation>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="border-bottom py-2">
      <app-calendar [location]="this.house.location"></app-calendar>
    </div>
  </div>
  <div class="">
    <div class="row justify-content-center justify-content-md-between">
      <h4 class="h4 mt-4">
        {{ TEXTS.ratings }}
      </h4>
      @for (valuation of house.valuations; track valuation; let i = $index) {
        <div class="col-11 col-md-5 my-4 py-3 border shadow rounded">
          <div class="row">
            <div class="col-1 me-3 mt-2">
              <img class="rounded-circle img-size" src="{{ valuation.img }}" />
            </div>
            <div class="col-9 mt-1 ms-3">
              <h5 class="h5">{{ valuation.name }}</h5>
              <p>{{ valuation.city }}, {{ valuation.country }}</p>
            </div>
          </div>
          <div class="row">
            <div class="col-12 col-sm-2 col-md-4 col-lg-3 col-xxl-2">
              @for (star of [1, 2, 3, 4, 5]; track star) {
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="10"
                  height="10"
                  style="margin-right: 1px"
                  [attr.fill]="
                    star <= valuation.stars ? 'currentColor' : '#e2e2e2'
                  "
                  class="bi bi-star-fill"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"
                  />
                </svg>
              }
            </div>
            <div class="col-12 col-sm-8">
              <p>
                {{
                  valuation.date.toLocaleString("es-ES", {
                    month: "long",
                    year: "numeric"
                  })
                }}
              </p>
            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <p
                [ngClass]="{ 'show-more': isExpanded[i] }"
                class="text-container"
              >
                {{ valuation.text }}
              </p>
            </div>
            <div class="col-12">
              @if (!isExpanded[i]) {
                <a class="btn btn-link text-dark fw-bold" (click)="expand(i)"
                  >Mostrar mas</a
                >
              } @else {
                <a class="btn btn-link text-dark fw-bold" (click)="expand(i)"
                  >Mostrar menos</a
                >
              }
            </div>
          </div>
        </div>
      }
    </div>
  </div>
</div>

<!-- <div class="screen-container">
    <h1>{{house.houseName}}</h1>

    <div class="prueba">
        <div class="prueba2">

            <div class="details-container">
                <h2 class="house-location" *ngIf="house.location && house.houseType">
                    {{house.houseType}} {{TEXTS.locatedIn}} {{house.location}}
                </h2>
                <h3 class="house-information">
                    <app-housing-info-displayer [housingInformation]="this.house.informationOfNumber"/>
                </h3>
            </div>

            <div class="valuations-container" *ngIf="house.houseDescriptionParagraphs?.length != 0">
                <h2 class="house-description">
                    {{TEXTS.description}}
                </h2>

                @for (parragraphs of house.houseDescriptionParagraphs; track parragraphs) {
                    <h3 class="house-detail">
                        {{parragraphs}}
                    </h3>
                }
            </div>

            <div class="valuations-container" *ngIf="house.services">
                <h2 class="subtitle">
                    {{TEXTS.servicesList}}
                </h2>

                <div class="services-container">
                    @for (service of house.services; track service) {
                        <h4 class="services"> {{service}} </h4>
                    }
                </div>

            </div>

        </div>
        <div class="prueba3">
            <app-housing-reservation [housingPrice]="this.house.prices" [rules]="this.house.rules"/>
        </div>
    </div>

    <div class="valuations-container">
        <app-calendar [location]="this.house.location"></app-calendar>
    </div>


    <div class="valuations-container">

        <h2 class="subtitle">
            {{TEXTS.ratings}}
        </h2>

        <div class="reviews-container">
            @for (valuation of house.valuations; track  valuation; let i = $index) {
                <div class="primary">
                    <div style="display: flex;">
                        <img class="valuation-img" src={{valuation.img}}>
                        <div class="valuation-info">
                            <h2 class="user-name">{{valuation.name}}</h2>
                            <div class="user-location">
                                {{valuation.city}},
                                {{valuation.country}}
                            </div>
                        </div>
                    </div>
                    <div class="stars-and-date">
                        <div class = "stars-card">
                            @for (star of [1,2,3,4,5]; track star) {
                                <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" style="margin-right: 1px;" [attr.fill]="star <= valuation.stars ? 'currentColor' : '#e2e2e2'"  class="bi bi-star-fill" viewBox="0 0 16 16">
                                    <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                                </svg>
                            }
                        </div>
                        <div class="date">
                            {{ valuation.date.toLocaleString('es-ES', { month: 'long', year: 'numeric' }) }}
                        </div>
                    </div>
                    <div class = "info-card">
                        <h2 [ngClass]="{'valuation': !isExpanded[i], 'valuation2': isExpanded[i]}">
                            {{valuation.text}}
                        </h2>
                        <a class="show-more" (click)="expand(i)">
                            {{ isExpanded[i] ? 'Mostrar menos': 'Mostrar mas' }}
                        </a>

                    </div>
                </div>
            }
        </div>
    </div>

    <button class="btn btn-secondary" (click)="volver()">volver</button>

</div> -->
